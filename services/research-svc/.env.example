# Research Service Environment Configuration
# Copy to .env and fill in values

# Database connection (research-svc database)
DATABASE_URL="postgresql://postgres:postgres@localhost:5432/aivo_research?schema=public"

# Warehouse database (read-only access for exports)
WAREHOUSE_DATABASE_URL="postgresql://postgres:postgres@localhost:5432/aivo_warehouse?schema=public"

# JWT secret for token verification
JWT_SECRET="your-jwt-secret-here"

# NATS connection for event publishing
NATS_URL="nats://localhost:4222"

# ═══════════════════════════════════════════════════════════════════════════════
# S3 Storage Configuration
# ═══════════════════════════════════════════════════════════════════════════════

# AWS Region
AWS_REGION=us-east-1

# AWS Credentials (use IAM roles in production)
AWS_ACCESS_KEY_ID=""
AWS_SECRET_ACCESS_KEY=""

# S3 Bucket for research exports
S3_RESEARCH_EXPORT_BUCKET="aivo-research-exports"

# KMS Key for server-side encryption (required for FERPA/COPPA compliance)
# Can be a key ID, key ARN, or alias (e.g., "alias/aivo-research-exports")
S3_KMS_KEY_ID="alias/aivo-research-exports"

# Optional: Custom S3 endpoint (for MinIO/LocalStack in development)
# S3_ENDPOINT="http://localhost:9000"
# S3_FORCE_PATH_STYLE="true"

# Presigned URL expiry (hours, default 24)
RESEARCH_EXPORT_URL_EXPIRY_HOURS=24

# ═══════════════════════════════════════════════════════════════════════════════
# Privacy & De-identification
# ═══════════════════════════════════════════════════════════════════════════════

# De-identification salt (MUST be kept secret and consistent)
# Used for consistent pseudonymization across exports
RESEARCH_DEIDENTIFICATION_SALT="your-secure-random-salt-here"

# K-anonymity threshold (minimum learners per cohort)
K_ANONYMITY_THRESHOLD=10

# Export file retention (days before expiry)
EXPORT_RETENTION_DAYS=30

# ═══════════════════════════════════════════════════════════════════════════════
# Server Configuration
# ═══════════════════════════════════════════════════════════════════════════════

PORT=3040
NODE_ENV=development
CORS_ORIGINS="http://localhost:3000"
