# AIVO Platform - NATS Server Configuration
# ══════════════════════════════════════════════════════════════════════════════
# NATS JetStream configuration for event-driven architecture.
# ══════════════════════════════════════════════════════════════════════════════

# Server identification
server_name: aivo-nats-dev

# ══════════════════════════════════════════════════════════════════════════════
# Network Configuration
# ══════════════════════════════════════════════════════════════════════════════

# Client connections
port: 4222

# HTTP monitoring
http_port: 8222

# Cluster configuration (for future expansion)
cluster {
  name: aivo-cluster
  port: 6222
  
  # Routes to other cluster members (empty for single node)
  routes = []
}

# ══════════════════════════════════════════════════════════════════════════════
# JetStream Configuration
# ══════════════════════════════════════════════════════════════════════════════

jetstream {
  # Persistence directory
  store_dir: /data/jetstream
  
  # Memory limits
  max_memory_store: 256MB
  
  # File storage limits
  max_file_store: 1GB
  
  # Domain for multi-cluster setups
  domain: aivo
}

# ══════════════════════════════════════════════════════════════════════════════
# Logging
# ══════════════════════════════════════════════════════════════════════════════

# Debug logging (set to true for troubleshooting)
debug: false

# Trace logging (very verbose)
trace: false

# Include timestamps in log messages
logtime: true

# Log file (stdout for Docker)
# log_file: "/var/log/nats/nats.log"

# ══════════════════════════════════════════════════════════════════════════════
# Limits
# ══════════════════════════════════════════════════════════════════════════════

# Maximum number of connections
max_connections: 1000

# Maximum payload size (8MB for larger messages)
max_payload: 8MB

# Maximum pending size
max_pending: 64MB

# Maximum control line size
max_control_line: 4KB

# Ping interval for connection health
ping_interval: 30s

# Maximum outstanding pings before disconnect
ping_max: 3

# Write deadline for network writes
write_deadline: 10s

# ══════════════════════════════════════════════════════════════════════════════
# Authorization (Development - Permissive)
# ══════════════════════════════════════════════════════════════════════════════

# For development, allow all publish/subscribe
# In production, use proper authentication
authorization {
  default_permissions = {
    publish = ">"
    subscribe = ">"
  }
}

# ══════════════════════════════════════════════════════════════════════════════
# TLS Configuration (Disabled for local development)
# ══════════════════════════════════════════════════════════════════════════════

# tls {
#   cert_file: "/etc/nats/certs/server-cert.pem"
#   key_file: "/etc/nats/certs/server-key.pem"
#   ca_file: "/etc/nats/certs/ca.pem"
#   verify: true
# }

# ══════════════════════════════════════════════════════════════════════════════
# Accounts (Future: Multi-tenancy isolation)
# ══════════════════════════════════════════════════════════════════════════════

# accounts {
#   AIVO {
#     users = [
#       { user: aivo-services, password: $NATS_PASSWORD }
#     ]
#     exports = [
#       { stream: "events.>" }
#     ]
#   }
# }
