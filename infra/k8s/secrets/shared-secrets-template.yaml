# ============================================================================
# Shared Infrastructure Secrets Template
# ============================================================================
#
# DO NOT commit actual secret values to version control!
#
# Usage:
#   1. Copy this file to shared-secrets.yaml (gitignored)
#   2. Replace placeholder values with actual secrets
#   3. Apply with: kubectl apply -f shared-secrets.yaml
#
# For production:
#   - Use external secrets management (Vault, AWS Secrets Manager, etc.)
#   - Consider using sealed-secrets or external-secrets-operator
#
# ============================================================================

---
apiVersion: v1
kind: Secret
metadata:
  name: shared-secrets
  namespace: aivo
  labels:
    app.kubernetes.io/part-of: aivo
    app.kubernetes.io/component: secrets
type: Opaque
stringData:
  # Redis connection URL
  # Format: redis://[username:password@]host:port[/database]
  redis-url: "redis://redis.aivo-infra.svc.cluster.local:6379"

  # NATS connection URL
  # Format: nats://[username:password@]host:port
  nats-url: "nats://nats.aivo-infra.svc.cluster.local:4222"

  # PostgreSQL connection URL (shared for services that need cross-db access)
  # Individual services should have their own database secrets
  postgres-host: "postgres.aivo-infra.svc.cluster.local"
  postgres-port: "5432"
  postgres-user: "aivo"
  postgres-password: "REPLACE_WITH_SECURE_PASSWORD"

---
# Example service-specific secret template
# Copy and modify for each service
apiVersion: v1
kind: Secret
metadata:
  name: auth-svc-secrets
  namespace: aivo
  labels:
    app.kubernetes.io/name: auth-svc
    app.kubernetes.io/component: secrets
type: Opaque
stringData:
  # Database URL for this service's database
  database-url: "postgresql://aivo:REPLACE_PASSWORD@postgres.aivo-infra.svc.cluster.local:5432/aivo_auth"

  # JWT Keys (RS256 recommended for production)
  # Generate with: openssl genrsa -out private.pem 2048
  #                openssl rsa -in private.pem -pubout -out public.pem
  jwt-private-key: |
    -----BEGIN RSA PRIVATE KEY-----
    REPLACE_WITH_ACTUAL_PRIVATE_KEY
    -----END RSA PRIVATE KEY-----

  jwt-public-key: |
    -----BEGIN PUBLIC KEY-----
    REPLACE_WITH_ACTUAL_PUBLIC_KEY
    -----END PUBLIC KEY-----

  # SSO State Encryption Key (32 bytes, base64 encoded)
  # Generate with: openssl rand -base64 32
  sso-state-encryption-key: "REPLACE_WITH_32_BYTE_BASE64_KEY"

---
apiVersion: v1
kind: Secret
metadata:
  name: billing-svc-secrets
  namespace: aivo
  labels:
    app.kubernetes.io/name: billing-svc
    app.kubernetes.io/component: secrets
type: Opaque
stringData:
  database-url: "postgresql://aivo:REPLACE_PASSWORD@postgres.aivo-infra.svc.cluster.local:5432/aivo_billing"
  jwt-secret: "REPLACE_WITH_SECURE_JWT_SECRET"

  # Stripe API Keys
  # Get from: https://dashboard.stripe.com/apikeys
  stripe-secret-key: "sk_live_REPLACE_WITH_SECRET_KEY"
  stripe-publishable-key: "pk_live_REPLACE_WITH_PUBLISHABLE_KEY"

  # Stripe Webhook Secret
  # Get from: https://dashboard.stripe.com/webhooks
  stripe-webhook-secret: "whsec_REPLACE_WITH_WEBHOOK_SECRET"

---
apiVersion: v1
kind: Secret
metadata:
  name: notify-svc-secrets
  namespace: aivo
  labels:
    app.kubernetes.io/name: notify-svc
    app.kubernetes.io/component: secrets
type: Opaque
stringData:
  database-url: "postgresql://aivo:REPLACE_PASSWORD@postgres.aivo-infra.svc.cluster.local:5432/aivo_notification"

  # SendGrid API Key
  # Get from: https://app.sendgrid.com/settings/api_keys
  sendgrid-api-key: "SG.REPLACE_WITH_API_KEY"

  # AWS SES Credentials (if using SES as fallback)
  aws-access-key-id: "REPLACE_WITH_ACCESS_KEY"
  aws-secret-access-key: "REPLACE_WITH_SECRET_KEY"

  # Twilio Credentials (for SMS)
  twilio-account-sid: "REPLACE_WITH_ACCOUNT_SID"
  twilio-auth-token: "REPLACE_WITH_AUTH_TOKEN"

  # Firebase/FCM Credentials (for push notifications)
  firebase-private-key: |
    -----BEGIN PRIVATE KEY-----
    REPLACE_WITH_FIREBASE_PRIVATE_KEY
    -----END PRIVATE KEY-----
  firebase-client-email: "firebase-adminsdk@project.iam.gserviceaccount.com"
  firebase-project-id: "your-firebase-project-id"

  # APNs Credentials (for iOS push)
  apns-key-id: "REPLACE_WITH_KEY_ID"
  apns-team-id: "REPLACE_WITH_TEAM_ID"
  apns-private-key: |
    -----BEGIN PRIVATE KEY-----
    REPLACE_WITH_APNS_PRIVATE_KEY
    -----END PRIVATE KEY-----
